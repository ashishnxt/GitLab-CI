# GitLab CI/CD One‑Shot Demo – Step‑by‑Step Guide

This document explains how to create a basic **GitLab CI/CD pipeline** from scratch, including groups, projects, pipelines, parallel jobs, variables, artifacts, and runners.

---

<img width="3199" height="1999" alt="Screenshot 2026-01-25 164234" src="https://github.com/user-attachments/assets/506a9916-c66c-4f08-921e-6cd542a279a6" />

## 1. GitLab Project Setup

### 1.1 Create a Group

* **Group Name:** `gitlab-one-shot`
* Purpose: Used to logically organize related projects.

### 1.2 Create a Project

* **Project Name:** `Demo`
* Create this project inside the `gitlab-one-shot` group.

### 1.3 Import an Existing Repository

* Import an existing Git repository (example: **todo node CI/CD project**).
* This repository will be used to demonstrate the CI/CD pipeline.

---

## 2. GitLab CI/CD Pipeline Overview

GitLab pipelines are defined using a `.gitlab-ci.yml` file placed in the root of the repository.

### Pipeline Stages

We will use the following stages:

* **Build** – Build the application
* **Test** – Run tests and scans (parallel jobs)
* **Push** – Push artifacts/images
* **Deploy** – Deploy the application

---

<img width="3199" height="1999" alt="Screenshot 2026-01-25 170649" src="https://github.com/user-attachments/assets/bb9137e4-87e1-435c-af43-0ccc7a85f663" />

## 3. Demo CI Pipeline (`.gitlab-ci.yml`)

### 3.1 Stage Definition

```yaml
stages:
  - Build
  - Test
  - Push
  - Deploy
```

---

### 3.2 Jobs Implementation

#### Build Stage

```yaml
Build-stage:
  stage: Build
  script:
    - echo "This is Build stage..."
```

#### Test Stage (Parallel Jobs)

Multiple jobs can run in parallel if they belong to the same stage.

```yaml
Test-stage:
  stage: Test
  script:
    - echo "This is Testing stage..."

Scan-stage:
  stage: Test
  script:
    - echo "Scanning the image..."

Bug-stage:
  stage: Test
  script:
    - echo "Finding bugs in the image..."
```

> **Note:** `Test-stage`, `Scan-stage`, and `Bug-stage` run in parallel because they share the same stage name.

#### Push Stage

```yaml
Push-stage:
  stage: Push
  script:
    - echo "This is Push stage..."
```

#### Deploy Stage

```yaml
Deploy-stage:
  stage: Deploy
  script:
    - echo "This is Deploy stage..."
```

---

<img width="3190" height="1996" alt="Screenshot 2026-01-25 173211" src="https://github.com/user-attachments/assets/13cd46b1-ff93-4ace-93f5-cb86effb851d" />

## 4. Variables in GitLab CI/CD

Variables help manage configuration values securely and dynamically.

<img width="3189" height="1999" alt="Screenshot 2026-01-25 164326" src="https://github.com/user-attachments/assets/c76449a5-9617-4a74-950a-2f7982d68802" />

<img width="3191" height="1997" alt="Screenshot 2026-01-25 170241" src="https://github.com/user-attachments/assets/9e45e465-2806-4c86-9bfb-f02faf9fe979" />

### 4.1 Predefined Variables

GitLab provides built‑in variables automatically during each pipeline run.

Example:

* `$CI_PROJECT_NAME`
* `$CI_COMMIT_AUTHOR`

Usage example:

```bash
echo "Project Name: $CI_PROJECT_NAME"
```

---

<img width="3192" height="1990" alt="Screenshot 2026-01-25 173324" src="https://github.com/user-attachments/assets/216bc96c-57a4-4bd1-9b5c-365d44ffb5aa" />

### 4.2 User‑Defined Variables (Local)

Defined directly in `.gitlab-ci.yml`.

```yaml
variables:
  DEPLOY_ENV: "Production"
  GITLAB_USER_KEY: "This-is-my-secret-key"
```

---

### 4.3 Global User‑Defined Variables

These variables can be reused across all jobs in the pipeline.

```yaml
variables:
  DEPLOY_ENV: "Production"
  GITLAB_USER_KEY: "This-is-my-secret-key"

Scan-stage:
  stage: Test
  script:
    - echo "Scanning the image using $GITLAB_USER_KEY..."
```

> **Best Practice:** Store sensitive values in **GitLab → Settings → CI/CD → Variables** instead of hardcoding them.

---

## 5. Artifacts in GitLab

Artifacts are files generated by jobs that can be stored and shared with team members.

### Common Artifact Types

* Logs
* Test reports
* Build outputs

### Example: Test Artifacts

```yaml
Test-stage:
  stage: Test
  script:
    - echo "This is Testing stage committed by $CI_COMMIT_AUTHOR"
    - mkdir -p logs
    - echo "These are test results" > logs/test.log
  artifacts:
    paths:
      - logs/
    expire_in: 1 week
```

* `test.log` stores test execution logs.
* Artifacts remain available for **1 week**.

---

<img width="3192" height="1990" alt="Screenshot 2026-01-25 205023" src="https://github.com/user-attachments/assets/ade28493-b835-41b9-bef2-56cfa5abb517" />

## 6. GitLab Runner Setup

### 6.1 Install GitLab Runner

* Install `gitlab-runner` on a machine (VM or server).
* This machine will execute CI/CD jobs.

### 6.2 Register the Runner

* Register the runner with the specific project.
* Assign a **runner tag**.

**Runner Tag Example:** `Development-ENV`

---


<img width="3199" height="1999" alt="Screenshot 2026-01-26 111945" src="https://github.com/user-attachments/assets/a7dbe67a-33a6-408e-9267-04a50d70b93f" />

## Comment this line in .bash_logout file.

<img width="2606" height="794" alt="Screenshot 2026-01-31 194648" src="https://github.com/user-attachments/assets/94ee3e42-0b7e-42e9-81f5-ae913a552177" />

<img width="3199" height="1999" alt="Screenshot 2026-01-26 172129" src="https://github.com/user-attachments/assets/2a3d37cf-1833-4e33-8c01-b48144061ef9" />

## 7. Using Runner Tags in Pipeline

Specify tags in `.gitlab-ci.yml` to ensure jobs run on the correct runner.

```yaml
stages:
  - Build
  - Test
  - Push
  - Deploy

variables:
  DEPLOY_ENV: "Production"
  GITLAB_USER_KEY: "This-is-my-secret-key"

Build-stage:
  stage: Build
  script:
    - echo "This $CI_PROJECT_NAME is Build stage..."
  tags:
    - Development-ENV
```

---

<img width="3192" height="1990" alt="Screenshot 2026-01-25 173324" src="https://github.com/user-attachments/assets/d6ffbcca-5a8f-4dc3-aba5-49f89210dd83" />

<img width="3188" height="1999" alt="Screenshot 2026-01-25 173459" src="https://github.com/user-attachments/assets/47b09230-306c-4f71-a373-a1dea4102c3a" />

## 8. Summary

* Created a GitLab **Group** and **Project**
* Imported an existing repository
* Implemented a **multi‑stage CI/CD pipeline**
* Ran **parallel jobs** in the Test stage
* Used **predefined and user‑defined variables**
* Stored logs using **artifacts**
* Configured and used a **GitLab Runner with tags**

This setup provides a solid foundation for real‑world GitLab CI/CD workflows.
